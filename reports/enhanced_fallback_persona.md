# Enhanced Fallback í˜ë¥´ì†Œë‚˜ - í˜„ì‹¤ì  ì‡¼í•‘ íŒ¨í„´ ë°˜ì˜

## ğŸ¯ ê°œì„  ëª©í‘œ

ê¸°ì¡´ Fallback ëª¨ë“œì˜ **ë…ë¦½ ë¶„í¬ ë¬¸ì œ**ë¥¼ í•´ê²°í•˜ê³ , **ì‹¤ì œ ì‡¼í•‘ íŒ¨í„´**ì„ ë°˜ì˜í•˜ì—¬ ë” í˜„ì‹¤ì ì¸ í˜ë¥´ì†Œë‚˜ ìƒì„±

---

## ğŸ“Š ë°˜ì˜ëœ í˜„ì‹¤ì  íŒ¨í„´

### 1. **ë‚˜ì´-ì˜ˆì‚° ìƒê´€ê´€ê³„**

**ê°€ì„¤**: ë‚˜ì´ê°€ ë§ì„ìˆ˜ë¡ êµ¬ë§¤ë ¥ì´ ë†’ì•„ì§„ë‹¤

| ë‚˜ì´ëŒ€ | low | medium | high |
|--------|-----|--------|------|
| **18-25ì„¸** | 60% | 30% | 10% |
| **26-35ì„¸** | 30% | 50% | 20% |
| **36-50ì„¸** | 20% | 40% | 40% |
| **51-65ì„¸** | 15% | 35% | 50% |

**êµ¬í˜„**:
```python
def _get_budget_by_age(self, age: int) -> str:
    if age <= 25:
        return random.choices(["low", "medium", "high"], weights=[60, 30, 10])[0]
    elif age <= 35:
        return random.choices(["low", "medium", "high"], weights=[30, 50, 20])[0]
    # ...
```

---

### 2. **ë‚˜ì´-ìŠ¤íƒ€ì¼ ì„ í˜¸ë„**

**ê°€ì„¤**: ì Šì„ìˆ˜ë¡ íŠ¸ë Œë””, ë‚˜ì´ë“¤ìˆ˜ë¡ í´ë˜ì‹/ë¹ˆí‹°ì§€ ì„ í˜¸

| ë‚˜ì´ëŒ€ | trendy | casual | sporty | formal | vintage |
|--------|--------|--------|--------|--------|---------|
| **18-25ì„¸** | 40% | 30% | 20% | 5% | 5% |
| **26-35ì„¸** | 25% | 35% | 20% | 15% | 5% |
| **36-50ì„¸** | 10% | 40% | 15% | 25% | 10% |
| **51-65ì„¸** | 5% | 35% | 10% | 30% | 20% |

**êµ¬í˜„**:
```python
def _get_style_by_age(self, age: int) -> str:
    if age <= 25:
        return random.choices(
            ["trendy", "casual", "sporty", "formal", "vintage"],
            weights=[40, 30, 20, 5, 5]
        )[0]
    # ...
```

---

### 3. **ì˜ˆì‚°-êµ¬ë§¤ë¹ˆë„ ìƒê´€ê´€ê³„**

**ê°€ì„¤**: ì˜ˆì‚°ì´ ë†’ì„ìˆ˜ë¡ êµ¬ë§¤ ë¹ˆë„ê°€ ë†’ë‹¤

| ì˜ˆì‚° | weekly | monthly | occasionally |
|------|--------|---------|--------------|
| **low** | 5% | 25% | 70% |
| **medium** | 20% | 50% | 30% |
| **high** | 50% | 35% | 15% |

**êµ¬í˜„**:
```python
def _get_frequency_by_budget(self, budget: str) -> str:
    if budget == "low":
        return random.choices(
            ["occasionally", "monthly", "weekly"],
            weights=[70, 25, 5]
        )[0]
    # ...
```

---

### 4. **ì„±ë³„-ì¹´í…Œê³ ë¦¬ ì„ í˜¸ë„**

**ê°€ì„¤**: ì„±ë³„ì— ë”°ë¼ ì„ í˜¸í•˜ëŠ” ì¹´í…Œê³ ë¦¬ê°€ ë‹¤ë¥´ë‹¤

#### Male
| tops | bottoms | dresses | shoes | accessories | outerwear |
|------|---------|---------|-------|-------------|-----------|
| 30% | 25% | 5% | 20% | 10% | 15% |

#### Female
| tops | bottoms | dresses | shoes | accessories | outerwear |
|------|---------|---------|-------|-------------|-----------|
| 20% | 15% | 25% | 20% | 20% | 10% |

#### Non-binary
| tops | bottoms | dresses | shoes | accessories | outerwear |
|------|---------|---------|-------|-------------|-----------|
| 20% | 20% | 15% | 20% | 15% | 10% |

**êµ¬í˜„**:
```python
def _get_categories_by_gender(self, gender: str) -> List[str]:
    if gender == "Male":
        weights = [30, 25, 5, 20, 10, 15]
    elif gender == "Female":
        weights = [20, 15, 25, 20, 20, 10]
    else:  # Non-binary
        weights = [20, 20, 15, 20, 15, 10]
    
    return random.choices(all_categories, weights=weights, k=2)
```

---

## ğŸ”„ ê¸°ì¡´ vs ê°œì„  ë¹„êµ

### ê¸°ì¡´ Fallback ëª¨ë“œ

```python
# ì™„ì „ ë…ë¦½ ë¶„í¬
{
    "age": 65,           # ëœë¤
    "gender": "Male",    # ëœë¤
    "style": "trendy",   # ëœë¤ (ë¹„í˜„ì‹¤ì !)
    "budget": "low",     # ëœë¤ (ë¹„í˜„ì‹¤ì !)
    "frequency": "weekly", # ëœë¤
    "categories": ["dresses", "accessories"]  # ëœë¤ (ë¹„í˜„ì‹¤ì !)
}
```

**ë¬¸ì œì **:
- 65ì„¸ ë‚¨ì„±ì´ trendy ìŠ¤íƒ€ì¼ + low budget + dresses ì„ í˜¸ (ë¹„í˜„ì‹¤ì )

---

### ê°œì„ ëœ Fallback ëª¨ë“œ

```python
# í˜„ì‹¤ì  ìƒê´€ê´€ê³„ ë°˜ì˜
{
    "age": 65,           # ëœë¤
    "gender": "Male",    # ëœë¤
    "style": "formal",   # ë‚˜ì´ ê¸°ë°˜ (51-65ì„¸ â†’ formal 30%)
    "budget": "high",    # ë‚˜ì´ ê¸°ë°˜ (51-65ì„¸ â†’ high 50%)
    "frequency": "weekly", # ì˜ˆì‚° ê¸°ë°˜ (high â†’ weekly 50%)
    "categories": ["tops", "outerwear"]  # ì„±ë³„ ê¸°ë°˜ (Male â†’ tops 30%, outerwear 15%)
}
```

**ê°œì„ ì **:
- 65ì„¸ ë‚¨ì„± â†’ formal/casual ìŠ¤íƒ€ì¼, high budget, tops/bottoms ì„ í˜¸ (í˜„ì‹¤ì !)

---

## ğŸ“ˆ ì˜ˆì‹œ í˜ë¥´ì†Œë‚˜ ë¹„êµ

### ì˜ˆì‹œ 1: ì Šì€ ì—¬ì„±

**ê¸°ì¡´**:
```python
{"age": 23, "gender": "Female", "style": "vintage", "budget": "high", 
 "frequency": "occasionally", "categories": ["outerwear", "tops"]}
```
â†’ ë¹„í˜„ì‹¤ì  (ì Šì€ë° vintage + high budget + ë‚®ì€ ë¹ˆë„)

**ê°œì„ **:
```python
{"age": 23, "gender": "Female", "style": "trendy", "budget": "low", 
 "frequency": "occasionally", "categories": ["dresses", "shoes"]}
```
â†’ í˜„ì‹¤ì  (ì Šì€ ì—¬ì„± â†’ trendy + low budget + ë“œë ˆìŠ¤/ì‹ ë°œ ì„ í˜¸)

---

### ì˜ˆì‹œ 2: ì¤‘ë…„ ë‚¨ì„±

**ê¸°ì¡´**:
```python
{"age": 45, "gender": "Male", "style": "trendy", "budget": "low", 
 "frequency": "weekly", "categories": ["dresses", "accessories"]}
```
â†’ ë¹„í˜„ì‹¤ì  (ì¤‘ë…„ ë‚¨ì„±ì´ trendy + dresses)

**ê°œì„ **:
```python
{"age": 45, "gender": "Male", "style": "casual", "budget": "high", 
 "frequency": "weekly", "categories": ["tops", "shoes"]}
```
â†’ í˜„ì‹¤ì  (ì¤‘ë…„ ë‚¨ì„± â†’ casual + high budget + tops/shoes)

---

## âš¡ ì„±ëŠ¥ ì˜í–¥

### ì†ë„ í…ŒìŠ¤íŠ¸

| ëª¨ë“œ | í‰ê·  ì‹œê°„ | ë¹„ê³  |
|------|-----------|------|
| **ê¸°ì¡´ Fallback** | 0.000s | ë‹¨ìˆœ ëœë¤ |
| **ê°œì„  Fallback** | 0.001s | ê°€ì¤‘ì¹˜ ê³„ì‚° ì¶”ê°€ |
| **LLM ëª¨ë“œ** | 14.4s | ë§¤ìš° ëŠë¦¼ |

**ê²°ë¡ **: ê°œì„  í›„ì—ë„ **ì—¬ì „íˆ ì´ˆê³ ì†** (0.001s â‰ˆ ì¦‰ì‹œ)

---

## ğŸ² ë‹¤ì–‘ì„± ë¶„ì„

### ì¡°í•© ìˆ˜ ë³€í™”

**ê¸°ì¡´**:
- ì´ ì¡°í•©: 97,200ê°€ì§€
- ëª¨ë“  ì¡°í•©ì´ ë™ì¼ í™•ë¥ 

**ê°œì„ **:
- ì´ ì¡°í•©: ì—¬ì „íˆ 97,200ê°€ì§€
- í•˜ì§€ë§Œ **í˜„ì‹¤ì  ì¡°í•©ì˜ í™•ë¥ ì´ ë†’ìŒ**
- ë¹„í˜„ì‹¤ì  ì¡°í•©ë„ ìƒì„± ê°€ëŠ¥ (ë‹¤ì–‘ì„± ìœ ì§€)

---

## ğŸš€ ì ìš© ë°©ë²•

### 1. íŒŒì¼ êµì²´

```bash
# ê¸°ì¡´ íŒŒì¼ ë°±ì—…
cp src/simulation/virtual_user.py src/simulation/virtual_user_old.py

# ê°œì„  ë²„ì „ìœ¼ë¡œ êµì²´
cp src/simulation/virtual_user_enhanced.py src/simulation/virtual_user.py
```

### 2. A/B í…ŒìŠ¤íŠ¸ ì‹¤í–‰

```bash
python scripts/run_simulation.py --ab-test --users 1000 --llm 0 --seed 42
```

### 3. ê²°ê³¼ í™•ì¸

ê°œì„ ëœ í˜ë¥´ì†Œë‚˜ë¡œ ë” í˜„ì‹¤ì ì¸ A/B í…ŒìŠ¤íŠ¸ ê²°ê³¼ íšë“!

---

## ğŸ“Š ê¸°ëŒ€ íš¨ê³¼

### âœ… ì¥ì 

1. **í˜„ì‹¤ì„± í–¥ìƒ**: ì‹¤ì œ ì‡¼í•‘ íŒ¨í„´ ë°˜ì˜
2. **ì†ë„ ìœ ì§€**: ì—¬ì „íˆ 0.001s (ì´ˆê³ ì†)
3. **ë‹¤ì–‘ì„± ìœ ì§€**: 97,200ê°€ì§€ ì¡°í•©
4. **í†µê³„ì  íƒ€ë‹¹ì„±**: ë” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” A/B í…ŒìŠ¤íŠ¸

### âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ê°€ì¤‘ì¹˜ ì¡°ì • í•„ìš”**: ì‹¤ì œ ë°ì´í„° ë¶„ì„ í›„ ê°€ì¤‘ì¹˜ íŠœë‹
2. **ê³¼ì í•© ë°©ì§€**: ë„ˆë¬´ ê°•í•œ ìƒê´€ê´€ê³„ëŠ” ë‹¤ì–‘ì„± ê°ì†Œ
3. **ê²€ì¦ í•„ìš”**: ìƒì„±ëœ í˜ë¥´ì†Œë‚˜ ë¶„í¬ í™•ì¸

---

## ğŸ” ì¶”ê°€ ê°œì„  ê°€ëŠ¥ì„±

### 1. ì‹¤ì œ ë°ì´í„° ê¸°ë°˜ ê°€ì¤‘ì¹˜

í˜„ì¬ëŠ” **ê°€ì • ê¸°ë°˜** ê°€ì¤‘ì¹˜ ì‚¬ìš©
â†’ H&M ë°ì´í„° ë¶„ì„í•˜ì—¬ **ì‹¤ì œ ë¶„í¬** ë°˜ì˜ ê°€ëŠ¥

```python
# ì˜ˆ: H&M ë°ì´í„°ì—ì„œ ë‚˜ì´-ì˜ˆì‚° ë¶„í¬ ì¶”ì¶œ
age_budget_dist = analyze_hm_data()
```

### 2. ë” ë³µì¡í•œ ìƒê´€ê´€ê³„

- ë‚˜ì´ + ì„±ë³„ â†’ ìŠ¤íƒ€ì¼ (êµì°¨ íš¨ê³¼)
- ê³„ì ˆì„± ë°˜ì˜ (ì—¬ë¦„ â†’ ë“œë ˆìŠ¤ ì„ í˜¸ë„ ì¦ê°€)
- ì§€ì—­ì„± ë°˜ì˜ (ë„ì‹œ â†’ trendy, ì‹œê³¨ â†’ casual)

### 3. ì‹œê°„ëŒ€ë³„ íŒ¨í„´

- ì£¼ë§ vs í‰ì¼ êµ¬ë§¤ íŒ¨í„´
- ì‹œê°„ëŒ€ë³„ í™œë™ íŒ¨í„´

---

## ğŸ“ ê²°ë¡ 

**Enhanced Fallback ëª¨ë“œ**ëŠ”:
- âœ… í˜„ì‹¤ì ì¸ ì‡¼í•‘ íŒ¨í„´ ë°˜ì˜
- âœ… ì´ˆê³ ì† ì„±ëŠ¥ ìœ ì§€ (0.001s)
- âœ… ì¶©ë¶„í•œ ë‹¤ì–‘ì„± ë³´ì¥
- âœ… A/B í…ŒìŠ¤íŠ¸ì— ìµœì í™”

**ê¶Œì¥**: ì¦‰ì‹œ ì ìš©í•˜ì—¬ ë” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” A/B í…ŒìŠ¤íŠ¸ ìˆ˜í–‰!

---

**ìƒì„±ì¼**: 2026-01-15
**íŒŒì¼**: `src/simulation/virtual_user_enhanced.py`
**ê°œì„  í•­ëª©**: 4ê°€ì§€ í˜„ì‹¤ì  íŒ¨í„´ ë°˜ì˜
